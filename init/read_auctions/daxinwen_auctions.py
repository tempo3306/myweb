'''
倪锦华 310114198005110042 张叶妮 310226198611143224 范卫东 310230197102096976
郁兴 31011319890107571x 鲍红钢 310110196003151655 姚晓艳 310115199408075043
610302198403084560
310108197307204413 刘晓兰 320705196809210101 李之风 342623197603071625
| 54918104 1462 2018-10-31
54977450 1692 2018-11-30 54802308 1947 2018-09-30 54938415 1952 2018-11-30 54842080 1667 2018-09-30
54938613 1332 2018-10-31 55093570 7001 55016122 9646 54973373 7156 2018-10-31 55099783 1527 2018-12-31


'''
import pickle
from myweb.wsgi import *
from bid.models import Bid_hander, Bid_auction, Identify_code
import xlrd
from django.db import transaction
from tools.file_operation import open_excel
import logging

'''
 杨微微 310227198912010026 
 林经伟 342201198501062917 杨振 310109199703100515 张俊 310225198804061616 袁雯婷 310108199302250022 
 陈勇(310113198701075918 端木德路 10305199112272015 陈洁 31011319830820412X 王传蕾 310113198311290022 陈琦 310101198411131023
'''
'''
54801061 6315 2018-09-30 54713450 1126 2018-07-31 54892189 5734 2018-09-30 \
54901243 1363 2018-10-31 54881000 1953 2018-09-30 55084907 4195 2018-12-31 \
54718801 1350 2018-08-31 54843504 1119 2018-09-30 54874968 1527 2018-09-30 54761365 4967 2018-08-31

'''
'''
李莉 510722197909297845 许亮 1370303197306126337 齐嘉 310109196807095219 吴惠康 310107195807190817
周佳丽 310114199410054026 张福华 310107196605282021 张从顺 341226198312104512 孟利峰 310113197906063211 
王海云 320705197212230542 胡丽宁 310108198911072829 黄磊 310225197904010037 宋志扬 310107199109082112 史爱芳 320828197502212027
未知 321181198102200042 徐俊杰 310114198110101017 曹秀萍 310107196007230424 陈静 413024197804165110 张从额 341226198206074479 
徐哲文 310110199710180520 吴克梅 422228197901023621

'''
'''
55014771 9093 2018-12-31 55093633 7851 2018-12-31 54842242 1612 2018-10-31 54941594 8380 2018-11-30 
54932494 1476 2018-10-31 54916346 1359 2018-12-31 54944729 1321 2018-11-30 54784658 1604 2018-08-31 
55021636 1213 2018-12-31 54883639 1019 2018-09-30 54988437 1554 2018-11-30 54948574 1013 2018-10-31 
54992627 4158 2018-11-30 55096187 8604 2018-09-30 
55096928 1478 2018-12-31 54829631 1456 2018-08-31 55076833 1817 2018-12-31 54910528 8254 2018-10-31  
54810215 7056 2018-09-30 54769349 1986 2018-08-31

'''

'''
310225198411233819 陈进 341203198301230017 周潮 1310108196909244418 戴瑞虹 352124197112100322

'''
'''
54901178 1413 2018-10-31 54969350 1118 2018-11-30
54845074 3904 2018-08-31 54717311 2783 2018-07-31 

'''


def get_ids(ids):
    idlist = ids.split()
    return idlist


def get_auction(auctions):
    a_list = auctions.split()
    alen = len(a_list)
    bid_number = [a_list[i] for i in range(0, alen, 3)]
    bid_password = [a_list[i] for i in range(1, alen, 3)]
    expired = [a_list[i] for i in range(2, alen, 3)]
    return (bid_number, bid_password, expired)


def deal(ids, auctions):
    d1 = get_ids(ids)
    bid_number, bid_password, expired = get_auction(auctions)
    print(d1)

    ##保存 标书信息
    for i in range(10):
        a = 10001 + i
        ic = f'hdxw{a}'
        identify = Identify_code.objects.get(identify_code=ic)
        Bid_number = bid_number[i]
        Bid_password = bid_password[i]
        ID_number = d1[i]
        identify.auction.clear()  # 清除所有关系
        auction = Bid_auction.objects.filter(Bid_number=Bid_number)
        if auction:
            auction[0].identify_code = identify
            auction[0].save()
        else:
            Bid_auction.objects.create(Bid_number=Bid_number, Bid_password=Bid_password,
                                       ID_number=ID_number, identify_code=identify)





if __name__ == '__main__':
    ids = '''
310114198005110042  310226198611143224  310230197102096976
31011319890107571x  310110196003151655  310115199408075043
610302198403084560
310108197307204413  320705196809210101  342623197603071625


    '''

    auctions = '''
54918104 1462 2018-10-31
54977450 1692 2018-11-30 54802308 1947 2018-09-30 54938415 1952 2018-11-30 54842080 1667 2018-09-30 
54938613 1332 2018-10-31 55093570 7001 2018-09-30 55016122 9646 2018-09-30 54973373 7156 2018-10-31 
55099783 1527 2018-12-31

    '''

    deal(ids, auctions)
